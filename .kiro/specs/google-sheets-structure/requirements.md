# Requirements Document

## Introduction

Данная спецификация описывает требуемую структуру Google Таблицы для работы Telegram Fairy Bot. Таблица служит основным источником данных для викторины по архетипам личности и должна содержать все необходимые листы с правильной структурой столбцов.

## Requirements

### Requirement 1

**User Story:** Как администратор бота, я хочу иметь централизованное хранилище конфигурационных текстов, чтобы легко изменять сообщения бота без изменения кода.

#### Acceptance Criteria

1. WHEN администратор создает лист "Config" THEN система SHALL содержать столбцы "key" и "value"
2. WHEN бот запрашивает конфигурационное значение THEN система SHALL возвращать соответствующий текст из столбца "value"
3. WHEN в конфигурации используются переносы строк THEN система SHALL поддерживать символы "\\n" для форматирования

### Requirement 2

**User Story:** Как администратор контента, я хочу управлять вопросами викторины через таблицу, чтобы легко добавлять, изменять или удалять вопросы.

#### Acceptance Criteria

1. WHEN администратор создает лист "Questions" THEN система SHALL содержать столбцы "question_id", "question_text", "prompt_text"
2. WHEN бот загружает вопрос по ID THEN система SHALL возвращать текст вопроса и подсказку
3. WHEN вопросы нумеруются THEN система SHALL использовать последовательные числа от 1 до 19

### Requirement 3

**User Story:** Как администратор контента, я хочу управлять вариантами ответов для каждого вопроса, чтобы настраивать логику подсчета архетипов.

#### Acceptance Criteria

1. WHEN администратор создает лист "Answers" THEN система SHALL содержать столбцы "answer_id", "question_id", "answer_text", "archetype_id"
2. WHEN бот загружает ответы для вопроса THEN система SHALL возвращать все ответы с соответствующим question_id
3. WHEN пользователь выбирает ответ THEN система SHALL начислять баллы соответствующему архетипу

### Requirement 4

**User Story:** Как администратор контента, я хочу управлять описаниями архетипов, чтобы предоставлять пользователям персонализированные результаты.

#### Acceptance Criteria

1. WHEN администратор создает лист "Archetypes" THEN система SHALL содержать столбцы "archetype_id", "main_description", "secondary_description"
2. WHEN бот показывает результаты THEN система SHALL использовать "main_description" для основного архетипа
3. WHEN бот показывает результаты THEN система SHALL использовать "secondary_description" для второго и третьего архетипов

### Requirement 5

**User Story:** Как разработчик, я хочу иметь четкую документацию структуры таблицы, чтобы правильно настроить интеграцию с Google Sheets API.

#### Acceptance Criteria

1. WHEN разработчик настраивает таблицу THEN система SHALL предоставлять примеры данных для каждого листа
2. WHEN разработчик интегрирует API THEN система SHALL поддерживать кэширование с TTL
3. WHEN происходит ошибка доступа к листу THEN система SHALL логировать понятные сообщения об ошибках

### Requirement 6

**User Story:** Как администратор системы, я хочу иметь правильные права доступа к таблице, чтобы бот мог читать данные через Service Account.

#### Acceptance Criteria

1. WHEN создается Service Account THEN система SHALL иметь доступ к Google Sheets API
2. WHEN настраиваются права доступа THEN Service Account SHALL иметь права на чтение таблицы
3. WHEN бот подключается к таблице THEN система SHALL успешно авторизоваться через JSON credentials